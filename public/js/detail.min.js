function qx(){$(".hf").css("padding-bottom","10px"),$(".huif").css("display","none"),$("#comment2").remove()}function hftj(){var jhf=document.getElementById("textarea2").value;jhf=jhf.replace(/<[\\S\s]*?\1>|<\/?(a|img)[^>]*>/gi,"");var hfHTML=encodeURIComponent(jhf);if(hfHTML.length>5){$.ajax({type:"post",url:"fyadd.aspx",data:{yy:pid,nr:hfHTML,ww:a},cache:!1,dataType:"text",success:function(data){"y"==data?window.location.reload():($("#err2").css("display","block"),$("#err2").addClass("dou2"))},error:function(){}})}}function doZoom(target,size){document.getElementById(target).style.fontSize=size+"pt"}var userid=$("#userid").html(),postid=$("#postid").html();$(".vote").click(function(){var target=$(this),another_target=target.siblings("a"),count=target.find("span").first().html(),another_count=another_target.find("span").first().html(),type=$(this).attr("type");if(userid){var result=vote(postid,type);result.inc&&target.find("span").first().html(Number(count)+1),result.dec&&another_target.find("span").first().html(Number(another_count)-1)}else $(".theme-popover-mask").fadeIn(100),$(".theme-popover").slideDown(200)}),$(".like").click(function(){var like_count=$(".like span").html();userid?$.ajax({url:"/post/like/?postid="+postid,cache:!1,type:"get",error:function(){console.log("error"),alert("发生了错误！")},success:function(e){console.log("success"),e.like&&(console.log("the like is "+e.like),$(".like span").html(Number(like_count)+1),$(".heart").addClass("heartAnimation")),e.dislike&&(console.log("the dislike is "+e.dislike),$(".like span").html(Number(like_count)-1),$(".heart").removeClass("heartAnimation"))}}):($(".theme-popover-mask").fadeIn(100),$(".theme-popover").slideDown(200))}),$(".agree").click(function(){var target=$(this),commentid=target.attr("commentid"),agree_count=target.children("span").html();userid?$.ajax({url:"/comment/agree/?commentid="+commentid,contentType:"application/json;charset=utf-8",cache:!1,dataType:"json",type:"GET",success:function(e){e.agree&&target.find("span").first().html(Number(agree_count)+1),e.disagree?target.find("span").first().html(Number(agree_count)-1):e.err&&alert("错误")},error:function(){console.log("error"),alert("发生了错误！")}}):($(".theme-popover-mask").fadeIn(100),$(".theme-popover").slideDown(200),alert("登陆后操作"))}),$(".collect").click(function(){userid?$.ajax({url:"/collect?postid="+postid,type:"get",error:function(e){console.log("error"+e),alert("发生了错误！")},success:function(e){e.collect&&alert("收藏成功！")}}):($(".theme-popover-mask").fadeIn(100),$(".theme-popover").slideDown(200))});var pid,_csrf;$(".hf").click(function(){_csrf=$("#_csrf").attr("value"),pid=$(this).attr("name"),$(".hf").css("padding-bottom","10px"),$("#comment2").remove();var appentxt='<form  class="huif" id="comment2" method="POST"  action="/comment"><input type="hidden" name="_csrf" value='+_csrf+'><textarea placeholder="回复" name="comment[content]" id="commentForm2" style="border-radius:5px;height:100px; width:100%;border-top: 1px solid #ebebeb;"></textarea><input type="hidden" name="comment[post]" value='+postid+'><button type="submit"  class="btn btn-primary top10">回复</button><a class="qxhf" onclick="qx()">取消回复</a></form>';$(this).parent().parent().after(appentxt);var target=$(this),toId=target.data("tid"),commentId=target.data("cid");$("#toId").length>0?$("#toId").val(toId):$("<input>").attr({type:"hidden",id:"toId",name:"comment[tid]",value:toId}).appendTo("#comment2"),$("#commentId").length>0?$("#commentId").val(commentId):$("<input>").attr({type:"hidden",id:"commentId",name:"comment[cid]",value:commentId}).appendTo("#comment2"),$("#commentForm2").attr("placeholder","在此留言回复")});