$(document).ready(function(){$("#editor").each(function(index,element){var img_csrf=$("#_csrf").attr("value");$(element).wysiwyg({classes:"some-more-classes",toolbar:0==index?"top-selection":1==index?"bottom":"selection",buttons:{dummybutton1:1!=index?!1:{html:$('<input id="submit" type="button" value="bold" />').click(function(){$(element).wysiwyg("shell").getSelectedHTML()?$(element).wysiwyg("shell").bold():alert("Please selection some text")}),showselection:!1},dummybutton2:1!=index?!1:{title:"Dummy",image:"",click:function($button){alert("Do something")},showselection:!1},smilies:{title:"Smilies",image:"",popup:function($popup,$button){var list_smilies=['<img src="smiley/afraid.png" width="16" height="16" alt="" />','<img src="smiley/amorous.png" width="16" height="16" alt="" />','<img src="smiley/angel.png" width="16" height="16" alt="" />','<img src="smiley/angry.png" width="16" height="16" alt="" />','<img src="smiley/bored.png" width="16" height="16" alt="" />','<img src="smiley/cold.png" width="16" height="16" alt="" />','<img src="smiley/confused.png" width="16" height="16" alt="" />','<img src="smiley/cross.png" width="16" height="16" alt="" />','<img src="smiley/crying.png" width="16" height="16" alt="" />','<img src="smiley/devil.png" width="16" height="16" alt="" />','<img src="smiley/disappointed.png" width="16" height="16" alt="" />','<img src="smiley/dont-know.png" width="16" height="16" alt="" />','<img src="smiley/drool.png" width="16" height="16" alt="" />','<img src="smiley/embarrassed.png" width="16" height="16" alt="" />','<img src="smiley/excited.png" width="16" height="16" alt="" />','<img src="smiley/excruciating.png" width="16" height="16" alt="" />','<img src="smiley/eyeroll.png" width="16" height="16" alt="" />','<img src="smiley/happy.png" width="16" height="16" alt="" />','<img src="smiley/hot.png" width="16" height="16" alt="" />','<img src="smiley/hug-left.png" width="16" height="16" alt="" />','<img src="smiley/hug-right.png" width="16" height="16" alt="" />','<img src="smiley/hungry.png" width="16" height="16" alt="" />','<img src="smiley/invincible.png" width="16" height="16" alt="" />','<img src="smiley/kiss.png" width="16" height="16" alt="" />','<img src="smiley/lying.png" width="16" height="16" alt="" />','<img src="smiley/meeting.png" width="16" height="16" alt="" />','<img src="smiley/nerdy.png" width="16" height="16" alt="" />','<img src="smiley/neutral.png" width="16" height="16" alt="" />','<img src="smiley/party.png" width="16" height="16" alt="" />','<img src="smiley/pirate.png" width="16" height="16" alt="" />','<img src="smiley/pissed-off.png" width="16" height="16" alt="" />','<img src="smiley/question.png" width="16" height="16" alt="" />','<img src="smiley/sad.png" width="16" height="16" alt="" />','<img src="smiley/shame.png" width="16" height="16" alt="" />','<img src="smiley/shocked.png" width="16" height="16" alt="" />','<img src="smiley/shut-mouth.png" width="16" height="16" alt="" />','<img src="smiley/sick.png" width="16" height="16" alt="" />','<img src="smiley/silent.png" width="16" height="16" alt="" />','<img src="smiley/sleeping.png" width="16" height="16" alt="" />','<img src="smiley/sleepy.png" width="16" height="16" alt="" />','<img src="smiley/stressed.png" width="16" height="16" alt="" />','<img src="smiley/thinking.png" width="16" height="16" alt="" />','<img src="smiley/tongue.png" width="16" height="16" alt="" />','<img src="smiley/uhm-yeah.png" width="16" height="16" alt="" />','<img src="smiley/wink.png" width="16" height="16" alt="" />','<img src="smiley/working.png" width="16" height="16" alt="" />','<img src="smiley/bathing.png" width="16" height="16" alt="" />','<img src="smiley/beer.png" width="16" height="16" alt="" />','<img src="smiley/boy.png" width="16" height="16" alt="" />','<img src="smiley/camera.png" width="16" height="16" alt="" />','<img src="smiley/chilli.png" width="16" height="16" alt="" />','<img src="smiley/cigarette.png" width="16" height="16" alt="" />','<img src="smiley/cinema.png" width="16" height="16" alt="" />','<img src="smiley/coffee.png" width="16" height="16" alt="" />','<img src="smiley/girl.png" width="16" height="16" alt="" />','<img src="smiley/console.png" width="16" height="16" alt="" />','<img src="smiley/grumpy.png" width="16" height="16" alt="" />','<img src="smiley/in_love.png" width="16" height="16" alt="" />','<img src="smiley/internet.png" width="16" height="16" alt="" />','<img src="smiley/lamp.png" width="16" height="16" alt="" />','<img src="smiley/mobile.png" width="16" height="16" alt="" />','<img src="smiley/mrgreen.png" width="16" height="16" alt="" />','<img src="smiley/musical-note.png" width="16" height="16" alt="" />','<img src="smiley/music.png" width="16" height="16" alt="" />','<img src="smiley/phone.png" width="16" height="16" alt="" />','<img src="smiley/plate.png" width="16" height="16" alt="" />','<img src="smiley/restroom.png" width="16" height="16" alt="" />','<img src="smiley/rose.png" width="16" height="16" alt="" />','<img src="smiley/search.png" width="16" height="16" alt="" />','<img src="smiley/shopping.png" width="16" height="16" alt="" />','<img src="smiley/star.png" width="16" height="16" alt="" />','<img src="smiley/studying.png" width="16" height="16" alt="" />','<img src="smiley/suit.png" width="16" height="16" alt="" />','<img src="smiley/surfing.png" width="16" height="16" alt="" />','<img src="smiley/thunder.png" width="16" height="16" alt="" />','<img src="smiley/tv.png" width="16" height="16" alt="" />','<img src="smiley/typing.png" width="16" height="16" alt="" />','<img src="smiley/writing.png" width="16" height="16" alt="" />'],$smilies=$("<div/>").addClass("wysiwyg-toolbar-smilies").attr("unselectable","on");$.each(list_smilies,function(index,smiley){0!=index&&$smilies.append(" ");var $image=$(smiley).attr("unselectable","on"),imagehtml=" "+$("<div/>").append($image.clone()).html()+" ";$image.css({cursor:"pointer"}).click(function(event){$(element).wysiwyg("shell").insertHTML(imagehtml)}).appendTo($smilies)});var $container=$(element).wysiwyg("container");$smilies.css({maxWidth:parseInt(.95*$container.width())+"px"}),$popup.append($smilies);var $toolbar=$button.parents(".wysiwyg-toolbar");if($toolbar.length){for(var left=0,top=0,node=$toolbar.get(0);node;)left+=node.offsetLeft,top+=node.offsetTop,node=node.offsetParent;return left+=parseInt(($toolbar.outerWidth()-$popup.outerWidth())/2),$toolbar.hasClass("wysiwyg-toolbar-top")?top-=$popup.height()-parseInt(1*$button.outerHeight()/4):top+=parseInt(3*$button.outerHeight()/4),$popup.css({left:left+"px",top:top+"px"}),!1}},showselection:2==index},insertimage:{title:"Insert image",image:"",showselection:!1},insertlink:{title:"Insert link",image:""},fontname:1==index?!1:{title:"Font",image:"",popup:function($popup,$button){var list_fontnames={"Arial, Helvetica":"Arial,Helvetica",Verdana:"Verdana,Geneva",Georgia:"Georgia","Courier New":"Courier New,Courier","Times New Roman":"Times New Roman,Times"},$list=$("<div/>").addClass("wysiwyg-toolbar-list").attr("unselectable","on");$.each(list_fontnames,function(name,font){var $link=$("<a/>").attr("href","#").css("font-family",font).html(name).click(function(event){return $(element).wysiwyg("shell").fontName(font).closePopup(),event.stopPropagation(),event.preventDefault(),!1});$list.append($link)}),$popup.append($list)},showselection:0==index},fontsize:1==index?!1:{title:"Size",image:"",popup:function($popup,$button){var list_fontsizes={Huge:7,Larger:6,Large:5,Normal:4,Small:3,Smaller:2,Tiny:1},$list=$("<div/>").addClass("wysiwyg-toolbar-list").attr("unselectable","on");$.each(list_fontsizes,function(name,size){var $link=$("<a/>").attr("href","#").css("font-size",8+3*size+"px").html(name).click(function(event){return $(element).wysiwyg("shell").fontSize(size).closePopup(),event.stopPropagation(),event.preventDefault(),!1});$list.append($link)}),$popup.append($list)}},header:1!=index?!1:{title:"Header",image:"",popup:function($popup,$button){var list_headers={"Header 1":"<h1>","Header 2":"<h2>","Header 3":"<h3>","Header 4":"<h4>","Header 5":"<h5>","Header 6":"<h6>",Preformatted:"<pre>"},$list=$("<div/>").addClass("wysiwyg-toolbar-list").attr("unselectable","on");$.each(list_headers,function(name,format){var $link=$("<a/>").attr("href","#").css("font-family",format).html(name).click(function(event){return $(element).wysiwyg("shell").format(format).closePopup(),event.stopPropagation(),event.preventDefault(),!1});$list.append($link)}),$popup.append($list)}},bold:{title:"Bold (Ctrl+B)",image:"",hotkey:"b"},italic:{title:"Italic (Ctrl+I)",image:"",hotkey:"i"},underline:{title:"Underline (Ctrl+U)",image:"",hotkey:"u"},strikethrough:{title:"Strikethrough (Ctrl+S)",image:"",hotkey:"s"},forecolor:{title:"Text color",image:""},highlight:{title:"Background color",image:""},alignleft:0!=index?!1:{title:"Left",image:"",showselection:!1},aligncenter:0!=index?!1:{title:"Center",image:"",showselection:!1},alignright:0!=index?!1:{title:"Right",image:"",showselection:!1},alignjustify:0!=index?!1:{title:"Justify",image:"",showselection:!1},subscript:1==index?!1:{title:"Subscript",image:"",showselection:!0},superscript:1==index?!1:{title:"Superscript",image:"",showselection:!0},indent:0!=index?!1:{title:"Indent",image:"",showselection:!1},outdent:0!=index?!1:{title:"Outdent",image:"",showselection:!1},orderedList:0!=index?!1:{title:"Ordered list",image:"",showselection:!1},unorderedList:0!=index?!1:{title:"Unordered list",image:"",showselection:!1},removeformat:{title:"Remove format",image:""}},submit:{title:"Submit",image:""},dropfileclick:"点击或拖拽图片到此处",placeholderUrl:"www.example.com",maxImageSize:[400,200],onImageUpload:function(insert_image){$(this).parents("form").append('<input type="hidden" name="_csrf" value='+img_csrf+">"),$(this).parents("form").attr("action","/post/pic").attr("method","POST").attr("enctype","multipart/form-data").ajaxSubmit({success:function(xhrdata,textStatus,jqXHR){var image_url=xhrdata.url;console.log("URL: "+image_url),insert_image(image_url)},error:function(e){console.log(e)}})}}).change(function(){"undefined"!=typeof console&&console.log("change")}).focus(function(){"undefined"!=typeof console&&console.log("focus")}).blur(function(){"undefined"!=typeof console&&console.log("blur")})});var option={element:$("#editor0").get(0),onkeypress:function(code,character,shiftKey,altKey,ctrlKey,metaKey){"undefined"!=typeof console&&console.log("RAW: "+character+" key pressed")},onselection:function(collapsed,rect,nodes,rightclick){"undefined"!=typeof console&&rect&&console.log("RAW: selection rect("+rect.left+","+rect.top+","+rect.width+","+rect.height+"), "+nodes.length+" nodes")},onplaceholder:function(visible){"undefined"!=typeof console&&console.log("RAW: placeholder "+(visible?"visible":"hidden"))}};wysiwyg(option)});